{"ast":null,"code":"// src/components/Page1.js\nimport React,{useState,useEffect}from'react';import{useNavigate}from'react-router-dom';import Header from'./Header';import firebase from'firebase/compat/app';import'firebase/compat/storage';import{ToastContainer,toast}from'react-toastify';import'react-toastify/dist/ReactToastify.css';import'./css/Page1.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const Page1=()=>{const[loading,setLoading]=useState(false);const[image,setImage]=useState(null);const handleFileChange=e=>{const file=e.target.files[0];if(file){setImage(file);}};const[formData,setFormData]=useState({name:'',description:'',quantity:''});const handleChange=e=>{const{name,value}=e.target;setFormData(prevData=>({...prevData,[name]:value}));};const handleSubmit=async e=>{e.preventDefault();try{setLoading(true);//lưu ảnh lên firebase\nconst storageRef=firebase.storage().ref();const fileRef=storageRef.child(image.name);await fileRef.put(image);const url=await fileRef.getDownloadURL();console.log('Download URL:',url);//url là link ảnh vừa lưu\nconst{name,description,quantity}=formData;const response=await fetch('https://lotteryapi20240124145714.azurewebsites.net/api/Prize',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({id:0,prizeName:name,imageLink:url,quantity:parseInt(quantity),prizeDescription:description,members:[]})});if(!response.ok){throw new Error('Failed to submit form');}setFormData({name:'',description:'',quantity:''});setLoading(false);toast(\"Thêm giải thưởng thành công\");console.log('Server response:',response);}catch(error){setLoading(false);console.error('Error submitting form:',error.message);}};return/*#__PURE__*/_jsxs(\"div\",{className:\"page1main\",children:[/*#__PURE__*/_jsx(ToastContainer,{}),/*#__PURE__*/_jsx(Header,{}),/*#__PURE__*/_jsx(\"div\",{className:\"page1screen\",children:/*#__PURE__*/_jsxs(\"div\",{style:{},children:[/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,style:{textAlign:'center'},children:[/*#__PURE__*/_jsx(\"p\",{className:\"title\",children:\"Th\\xEAm gi\\u1EA3i th\\u01B0\\u1EDFng m\\u1EDBi\"}),/*#__PURE__*/_jsxs(\"label\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"minititle\",children:\"T\\xEAn gi\\u1EA3i\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"name\",value:formData.name,onChange:handleChange,autoComplete:\"new-password\"})]}),/*#__PURE__*/_jsxs(\"label\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"minititle\",children:\"M\\xF4 t\\u1EA3\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"description\",value:formData.description,onChange:handleChange,autoComplete:\"new-password\"})]}),/*#__PURE__*/_jsxs(\"label\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"minititle\",children:\"S\\u1ED1 l\\u01B0\\u1EE3ng gi\\u1EA3i\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",name:\"quantity\",value:formData.quantity,onChange:handleChange,autoComplete:\"new-password\"})]}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",onChange:handleFileChange}),!loading&&/*#__PURE__*/_jsx(\"button\",{className:\"btnPage1\",type:\"submit\",children:\"Th\\xEAm\"}),loading&&/*#__PURE__*/_jsx(\"p\",{className:\"loading\",children:\"Loading...\"})]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{})]})})]});};export default Page1;","map":{"version":3,"names":["React","useState","useEffect","useNavigate","Header","firebase","ToastContainer","toast","jsx","_jsx","jsxs","_jsxs","Page1","loading","setLoading","image","setImage","handleFileChange","e","file","target","files","formData","setFormData","name","description","quantity","handleChange","value","prevData","handleSubmit","preventDefault","storageRef","storage","ref","fileRef","child","put","url","getDownloadURL","console","log","response","fetch","method","headers","body","JSON","stringify","id","prizeName","imageLink","parseInt","prizeDescription","members","ok","Error","error","message","className","children","style","onSubmit","textAlign","type","onChange","autoComplete"],"sources":["C:/Users/Hii/Desktop/Backup_Manager/manager/src/components/Page1.js"],"sourcesContent":["// src/components/Page1.js\r\nimport React, { useState, useEffect } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport Header from './Header';\r\nimport firebase from 'firebase/compat/app';\r\nimport 'firebase/compat/storage';\r\nimport { ToastContainer, toast } from 'react-toastify';\r\nimport 'react-toastify/dist/ReactToastify.css';\r\nimport './css/Page1.css';\r\n\r\nconst Page1 = () => {\r\n    const [loading, setLoading] = useState(false);\r\n    const [image, setImage] = useState(null);\r\n\r\n    const handleFileChange = (e) => {\r\n        const file = e.target.files[0];\r\n        if (file) {\r\n            setImage(file);\r\n        }\r\n    };\r\n    const [formData, setFormData] = useState({\r\n        name: '',\r\n        description: '',\r\n        quantity: ''\r\n    });\r\n\r\n    const handleChange = (e) => {\r\n        const { name, value } = e.target;\r\n        setFormData((prevData) => ({\r\n            ...prevData,\r\n            [name]: value,\r\n        }));\r\n    };\r\n\r\n    const handleSubmit = async (e) => {\r\n        e.preventDefault();\r\n\r\n        try {\r\n            setLoading(true);\r\n\r\n            //lưu ảnh lên firebase\r\n            const storageRef = firebase.storage().ref();\r\n            const fileRef = storageRef.child(image.name);\r\n            await fileRef.put(image);\r\n            const url = await fileRef.getDownloadURL();\r\n            console.log('Download URL:', url);\r\n            //url là link ảnh vừa lưu\r\n\r\n            const { name, description, quantity } = formData;\r\n            const response = await fetch('https://lotteryapi20240124145714.azurewebsites.net/api/Prize', {\r\n                method: 'POST',\r\n                headers: {\r\n                    'Content-Type': 'application/json',\r\n                },\r\n                body: JSON.stringify({\r\n                    id: 0,\r\n                    prizeName: name,\r\n                    imageLink: url,\r\n                    quantity: parseInt(quantity),\r\n                    prizeDescription: description,\r\n                    members: []\r\n                }),\r\n            });\r\n\r\n            if (!response.ok) {\r\n                throw new Error('Failed to submit form');\r\n            } setFormData({\r\n                name: '',\r\n                description: '',\r\n                quantity: ''\r\n            });\r\n\r\n            setLoading(false);\r\n            toast(\"Thêm giải thưởng thành công\");\r\n            console.log('Server response:', response);\r\n        } catch (error) {\r\n            setLoading(false);\r\n            console.error('Error submitting form:', error.message);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className='page1main'>\r\n            <ToastContainer />\r\n            <Header />\r\n            <div className='page1screen'>\r\n                <div style={{}}>\r\n                    <form onSubmit={handleSubmit} style={{ textAlign: 'center' }}>\r\n                        <p className='title'>Thêm giải thưởng mới</p>\r\n                        <label>\r\n                            <p className='minititle'>Tên giải</p>\r\n                            <input\r\n                                type=\"text\"\r\n                                name=\"name\"\r\n                                value={formData.name}\r\n                                onChange={handleChange}\r\n                                autoComplete=\"new-password\"\r\n                            />\r\n                        </label>\r\n                        <label>\r\n                            <p className='minititle'>Mô tả</p>\r\n                            <input\r\n                                type=\"text\"\r\n                                name=\"description\"\r\n                                value={formData.description}\r\n                                onChange={handleChange}\r\n                                autoComplete=\"new-password\"\r\n                            />\r\n                        </label>\r\n                        <label>\r\n                            <p className='minititle'>Số lượng giải</p>\r\n                            <input\r\n                                type=\"number\"\r\n                                name=\"quantity\"\r\n                                value={formData.quantity}\r\n                                onChange={handleChange}\r\n                                autoComplete=\"new-password\"\r\n                            />\r\n                        </label>\r\n                        <input type=\"file\" onChange={handleFileChange} />\r\n                        {!loading && <button className='btnPage1' type=\"submit\">Thêm</button>}\r\n                        {loading && <p className='loading' >Loading...</p>}\r\n                    </form>\r\n\r\n                    <br />\r\n                    <br />\r\n                </div>\r\n            </div>\r\n\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default Page1;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}